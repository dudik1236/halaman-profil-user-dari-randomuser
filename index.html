<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RandomUser â€¢ Profile (Online + Offline) â€” Stylish</title>
  <meta name="description" content="Halaman profil dinamis dari RandomUser API dengan desain atraktif, animasi, tema, filter NAT, badge gender/umur, offline fallback, timeout+retry, dan self-test. Siap GitHub Pages/Netlify/Vercel." />
  <meta property="og:title" content="RandomUser Stylish Profile" />
  <meta property="og:description" content="Profil dinamis dari RandomUser API + offline fallback. Coba sekarang!" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://randomuser.me/img/logo-random-user-generator.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { theme: { extend: { fontFamily: { sans: ["Inter","ui-sans-serif","system-ui"] }, colors: { brand: { 50:'#eef2ff',100:'#e0e7ff',200:'#c7d2fe',300:'#a5b4fc',400:'#818cf8',500:'#6366f1',600:'#4f46e5',700:'#4338ca',800:'#3730a3',900:'#312e81' } } } }, darkMode:'class' }
  </script>
  <style>
    :root { --blob1:#7c5cff; --blob2:#24d6d9; }
    .hero-bg{position:fixed;inset:0;z-index:-1;overflow:hidden}
    .blob{position:absolute;filter:blur(40px);opacity:.35;transform:translate(-50%,-50%);border-radius:50%}
    .blob.a{width:500px;height:500px;background:var(--blob1);top:-10%;left:10%;animation:floatA 14s ease-in-out infinite}
    .blob.b{width:650px;height:650px;background:var(--blob2);top:15%;left:85%;animation:floatB 18s ease-in-out infinite}
    .blob.c{width:520px;height:520px;background:#ff7ab6;top:95%;left:10%;animation:floatC 20s ease-in-out infinite}
    @keyframes floatA{0%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-48%,-47%) scale(1.15)}100%{transform:translate(-50%,-50%) scale(1)}}
    @keyframes floatB{0%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-52%,-53%) scale(1.08)}100%{transform:translate(-50%,-50%) scale(1)}}
    @keyframes floatC{0%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-47%,-52%) scale(1.12)}100%{transform:translate(-50%,-50%) scale(1)}}
    .glass{backdrop-filter:blur(10px);background:rgba(255,255,255,.65)}
    .dark .glass{background:rgba(17,24,39,.55)}
    .tilt{transform-style:preserve-3d;transition:transform .15s ease}
    .tilt:hover{transform:perspective(900px) rotateX(2deg) rotateY(-2deg) translateY(-2px)}
    .kbd{border:1px solid #cbd5e1;border-bottom-width:2px;border-radius:.5rem;padding:.15rem .4rem;font-size:.75rem;background:#fff}
    .dark .kbd{background:#0f172a;border-color:#334155}
    .shimmer{background:linear-gradient(100deg,rgba(148,163,184,.2) 20%,rgba(148,163,184,.4) 40%,rgba(148,163,184,.2) 60%);background-size:200% 100%;animation:shimmer 1.1s infinite}
    @keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
    #confetti{pointer-events:none;position:fixed;inset:0;z-index:40;display:none}
  </style>
</head>
<body class="min-h-screen font-sans bg-gradient-to-br from-slate-50 via-white to-indigo-50 text-slate-800 dark:from-slate-900 dark:via-slate-950 dark:to-indigo-950 dark:text-slate-100 transition-colors">
  <div class="hero-bg"><div class="blob a"></div><div class="blob b"></div><div class="blob c"></div></div>
  <canvas id="confetti"></canvas>

  <header class="sticky top-0 z-30 border-b border-slate-200/60 dark:border-slate-700/50 bg-white/70 dark:bg-slate-900/60 backdrop-blur">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="h-8 w-8 rounded-lg bg-gradient-to-br from-brand-500 to-cyan-400 shadow ring-2 ring-white/70 dark:ring-slate-900/40"></div>
        <h1 class="text-base sm:text-lg font-semibold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-brand-600 to-cyan-500">RandomUser Stylish Profile</h1>
      </div>
      <nav class="flex items-center gap-2">
        <label class="hidden sm:flex items-center gap-2 text-sm">
          <span class="text-slate-500 dark:text-slate-400">NAT</span>
          <select id="natSelect" class="glass border border-slate-200/70 dark:border-slate-700/60 rounded-xl px-2 py-2 text-sm focus:outline-none">
            <option value="">All</option>
            <option>ID</option><option>US</option><option>GB</option><option>FR</option><option>AU</option><option>CA</option><option>DE</option><option>ES</option><option>BR</option><option>IN</option><option>JP</option>
          </select>
        </label>
        <button id="btnTheme" class="glass border border-slate-200/70 dark:border-slate-700/60 rounded-xl px-3 py-2 text-sm">ðŸŒ— Tema</button>
        <button id="btnRefresh" class="glass border border-slate-200/70 dark:border-slate-700/60 rounded-xl px-3 py-2 text-sm">ðŸ”„ Online</button>
        <button id="btnOffline" class="glass border border-amber-300/70 dark:border-amber-600/60 bg-amber-100/60 dark:bg-amber-400/10 rounded-xl px-3 py-2 text-sm text-amber-800 dark:text-amber-300">ðŸ“´ Offline</button>
        <button id="btnShare" class="glass border border-blue-300/70 dark:border-blue-600/60 bg-blue-100/60 dark:bg-blue-500/10 rounded-xl px-3 py-2 text-sm text-blue-900 dark:text-blue-300">ðŸ”— Share</button>
        <button id="btnCopyLink" class="glass border border-slate-200/70 dark:border-slate-700/60 rounded-xl px-3 py-2 text-sm">ðŸ“‹ Salin Link</button>
        <button id="btnWA" class="glass border border-green-300/70 dark:border-green-600/60 bg-green-100/60 dark:bg-green-500/10 rounded-xl px-3 py-2 text-sm text-green-900 dark:text-green-300">ðŸŸ¢ WA</button>
      </nav>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 sm:px-6 py-8">
    <div id="banner" class="hidden mb-4 glass border border-slate-300/60 dark:border-slate-700/60 rounded-2xl p-3 text-sm"></div>

    <section class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <div class="lg:col-span-1">
        <div class="tilt rounded-3xl glass border border-slate-300/60 dark:border-slate-700/60 shadow-xl overflow-hidden">
          <div class="relative h-40 bg-gradient-to-br from-brand-500 to-cyan-400">
            <img id="coverFlag" alt="country flag" class="absolute right-3 bottom-3 h-7 w-10 object-cover rounded-md shadow ring-1 ring-white/80 hidden" />
          </div>
          <div class="px-6 -mt-12 pb-6">
            <div class="flex items-end gap-4">
              <div class="h-24 w-24 rounded-2xl overflow-hidden ring-4 ring-white/90 dark:ring-slate-900/60 bg-slate-100 dark:bg-slate-800 relative">
                <img id="avatar" alt="avatar" class="h-full w-full object-cover hidden"/>
                <div id="avatarSkel" class="absolute inset-0 shimmer"></div>
              </div>
              <div class="flex-1 pb-2">
                <p class="flex items-center gap-2">
                  <span id="name" class="text-2xl font-extrabold leading-tight tracking-tight">&nbsp;</span>
                  <span id="genderBadge" class="hidden text-xs px-2 py-1 rounded-full border"></span>
                  <span id="ageBadge" class="hidden text-xs px-2 py-1 rounded-full border"></span>
                </p>
                <p id="username" class="text-slate-500 dark:text-slate-400 text-sm">&nbsp;</p>
              </div>
            </div>

            <dl class="mt-6 space-y-3 text-sm">
              <div class="flex items-center gap-3"><span class="shrink-0">ðŸ“§</span><dd id="email" class="truncate">&nbsp;</dd></div>
              <div class="flex items-center gap-3"><span class="shrink-0">ðŸ“±</span><dd id="phone" class="truncate">&nbsp;</dd></div>
              <div class="flex items-center gap-3"><span class="shrink-0">ðŸŽ‚</span><dd id="dob" class="truncate">&nbsp;</dd></div>
              <div class="flex items-center gap-3"><span class="shrink-0">ðŸ•’</span><dd id="timezone" class="truncate">&nbsp;</dd></div>
            </dl>

            <div class="mt-6 grid grid-cols-2 gap-3">
              <a id="btnMail" target="_blank" rel="noreferrer" class="text-center glass border border-slate-200/70 dark:border-slate-700/60 rounded-xl px-3 py-2 text-sm hover:shadow-lg">Email</a>
              <a id="btnMap" target="_blank" rel="noreferrer" class="text-center glass border border-slate-200/70 dark:border-slate-700/60 rounded-xl px-3 py-2 text-sm hover:shadow-lg">Map</a>
            </div>
          </div>
        </div>
      </div>

      <div class="lg:col-span-2">
        <div class="rounded-3xl glass border border-slate-300/60 dark:border-slate-700/60 shadow-xl p-6">
          <h2 class="text-lg font-semibold mb-1">Tentang</h2>
          <p id="about" class="text-slate-700 dark:text-slate-300 leading-relaxed">Loadingâ€¦</p>

          <div class="mt-8 grid sm:grid-cols-2 gap-6">
            <div>
              <h3 class="font-semibold mb-2">Alamat</h3>
              <p id="address" class="text-slate-700 dark:text-slate-300">&nbsp;</p>
            </div>
            <div>
              <h3 class="font-semibold mb-2">IDs</h3>
              <ul class="text-slate-700 dark:text-slate-300 space-y-1 text-sm" id="ids">
                <li><span class="font-medium">UUID:</span> <span id="uuid">&nbsp;</span></li>
                <li><span class="font-medium">Registered:</span> <span id="registered">&nbsp;</span></li>
                <li><span class="font-medium">Nationality:</span> <span id="nat">&nbsp;</span></li>
              </ul>
            </div>
          </div>

          <div class="mt-8">
            <h3 class="font-semibold mb-2">Raw JSON</h3>
            <pre id="raw" class="text-xs bg-slate-900/90 text-slate-100 p-4 rounded-xl overflow-auto max-h-72"></pre>
            <div class="mt-3 flex flex-wrap gap-2">
              <button id="btnCopy" class="glass border border-slate-200/70 dark:border-slate-700/60 rounded-xl px-3 py-2 text-sm">Copy JSON</button>
              <button id="btnDownload" class="glass border border-slate-200/70 dark:border-slate-700/60 rounded-xl px-3 py-2 text-sm">Download JSON</button>
              <button id="btnSelfTest" class="glass border border-emerald-400/70 dark:border-emerald-600/60 bg-emerald-100/60 dark:bg-emerald-500/10 text-emerald-900 dark:text-emerald-300 rounded-xl px-3 py-2 text-sm">Run Selfâ€‘Test</button>
            </div>
            <p class="mt-3 text-xs text-slate-500 dark:text-slate-400">Shortcut: <span class="kbd">R</span> online, <span class="kbd">O</span> offline, <span class="kbd">T</span> tema.</p>
          </div>
        </div>
      </div>
    </section>

    <footer class="mt-10 text-center text-xs text-slate-600 dark:text-slate-400">
      Siap deploy di GitHub Pages / Netlify / Vercel. Data dari <a class="underline" href="https://randomuser.me/" target="_blank" rel="noreferrer">randomuser.me</a>.
    </footer>
  </main>

  <template id="aboutTmpl">
    <span>Hai, saya <strong>{{first}} {{last}}</strong> ({{gender}}) dan tinggal di {{city}}, {{country}}. Zona waktu: <span class="font-medium">{{tz}}</span>. Usia <span class="font-medium">{{age}}</span> tahun, username <span class="font-mono">@{{user}}</span>.</span>
  </template>

  <script>
    // ---------- Utilities ----------
    const $ = (id) => document.getElementById(id);
    const formatDate = (iso) => new Date(iso).toLocaleString(undefined, { dateStyle: 'medium' });
    const flagUrl = (code) => `https://flagcdn.com/w80/${String(code||'').toLowerCase()}.png`;

    function setText(id, text) { $(id).textContent = text ?? ''; }
    function toggleLoading(isLoading) { $('avatar').classList.toggle('hidden', isLoading); $('avatarSkel').classList.toggle('hidden', !isLoading); }
    function banner(msg, type = 'info') {
      const b = $('banner');
      b.className = `mb-4 glass border rounded-2xl p-3 text-sm ${type==='error'?'border-red-300 bg-red-100/70 text-red-900 dark:bg-red-400/10 dark:text-red-300 dark:border-red-700/60': type==='warn'?'border-amber-300 bg-amber-100/70 text-amber-900 dark:bg-amber-400/10 dark:text-amber-300 dark:border-amber-700/60':'border-sky-300 bg-sky-100/70 text-sky-900 dark:bg-sky-400/10 dark:text-sky-300 dark:border-sky-700/60'}`;
      b.textContent = msg; b.classList.remove('hidden');
    }

    // ---------- Confetti ----------
    function burstConfetti() {
      const canvas = $('confetti'); const ctx = canvas.getContext('2d');
      const W = canvas.width = innerWidth; const H = canvas.height = innerHeight;
      const N = 140; const parts = Array.from({length:N}, () => ({ x: Math.random()*W, y: -20-Math.random()*H*0.2, r: 4+Math.random()*3, s: 1+Math.random()*2, c: `hsl(${Math.random()
